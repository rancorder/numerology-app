import streamlit as st
import datetime
import pyperclip

# ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼ã®æ„å‘³ã‚’è¾æ›¸ã§ç®¡ç†
numerology_meanings = {
    1: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã«å„ªã‚Œã€è‡ªç«‹å¿ƒãŒå¼·ã„ã€‚",
    2: "å”èª¿æ€§ãŒã‚ã‚Šã€å¹³å’Œã‚’æ„›ã™ã‚‹ã€‚",
    3: "å‰µé€ çš„ã§ã€è¡¨ç¾åŠ›ãŒè±Šã‹ã€‚",
    4: "åŠªåŠ›å®¶ã§ã€å®‰å®šã‚’å¥½ã‚€ã€‚",
    5: "è‡ªç”±ã‚’æ„›ã—ã€å†’é™ºå¿ƒãŒå¼·ã„ã€‚",
    6: "è²¬ä»»æ„ŸãŒå¼·ãã€å®¶åº­çš„ã€‚",
    7: "çŸ¥çš„ã§ã€åˆ†æåŠ›ã«å„ªã‚Œã‚‹ã€‚",
    8: "é‡å¿ƒçš„ã§ã€æˆåŠŸã‚’æ±‚ã‚ã‚‹ã€‚",
    9: "åšæ„›ä¸»ç¾©è€…ã§ã€ç²¾ç¥çš„ã«æˆç†Ÿã—ã¦ã„ã‚‹ã€‚",
    11: "ç›´æ„ŸãŒé‹­ãã€ã‚«ãƒªã‚¹ãƒæ€§ãŒã‚ã‚‹ï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼‰ã€‚",
    22: "ç¾å®Ÿçš„ãªå¤¢ã‚’å®Ÿç¾ã§ãã‚‹å¼·ã„åŠ›ã‚’æŒã¤ï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼‰ã€‚",
    33: "å¥‰ä»•ã®ç²¾ç¥ã‚’æŒã¡ã€ã‚«ãƒªã‚¹ãƒæ€§ã«ã‚ãµã‚Œã‚‹ï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼‰ã€‚",
}

# ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°
def calculate_life_path_number(birthdate):
    digits = [int(d) for d in birthdate.replace("-", "")]  # ä¾‹: "1995-07-23" â†’ [1,9,9,5,7,2,3]
    total = sum(digits)
    
    # ãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼ˆ11, 22, 33ï¼‰ã¯ä¿æŒ
    while total > 9 and total not in (11, 22, 33):
        total = sum(map(int, str(total)))  # å„æ¡ã‚’å†åº¦è¶³ã™
    return total

# Streamlit UI
st.title("ğŸ”® æ•°ç§˜è¡“å ã„ã‚¢ãƒ—ãƒª ğŸ”®")
st.write("ã‚ãªãŸã®èª•ç”Ÿæ—¥ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼ã¨å ã„çµæœã‚’ãŠä¼ãˆã—ã¾ã™ï¼")

# ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«èª•ç”Ÿæ—¥ã‚’å…¥åŠ›ã•ã›ã‚‹
birthdate = st.date_input("èª•ç”Ÿæ—¥ã‚’é¸æŠã—ã¦ãã ã•ã„", min_value=datetime.date(1900, 1, 1), max_value=datetime.date.today())

if birthdate:
    # æ•°ç§˜è¡“ãƒŠãƒ³ãƒãƒ¼ã‚’è¨ˆç®—
    life_path_number = calculate_life_path_number(birthdate.strftime("%Y-%m-%d"))
    
    # çµæœã‚’è¡¨ç¤º
    st.subheader(f"ã‚ãªãŸã®ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼ã¯ã€{life_path_number}ã€‘ã§ã™ï¼")
    st.write(f"**{numerology_meanings.get(life_path_number, 'ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“')}**")

    # Xï¼ˆæ—§Twitterï¼‰æŠ•ç¨¿ç”¨ãƒ†ã‚­ã‚¹ãƒˆ
    tweet_text = f"ç§ã®ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼ã¯ã€{life_path_number}ã€‘ğŸ‰ {numerology_meanings.get(life_path_number, '')} #æ•°ç§˜è¡“ #å ã„"

    st.text_area("ğŸ“Œ Xã«æŠ•ç¨¿ã™ã‚‹ã«ã¯ã€ã“ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„:", tweet_text, height=100)

    if st.button("ğŸ“‹ ã‚³ãƒ”ãƒ¼ã™ã‚‹"):
        pyperclip.copy(tweet_text)
        st.success("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼Xã«è²¼ã‚Šä»˜ã‘ã¦æŠ•ç¨¿ã—ã¦ãã ã•ã„ã€‚")

# ãƒ•ãƒƒã‚¿ãƒ¼
st.write("ğŸ“… ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼ã¯ã€èª•ç”Ÿæ—¥ã®æ•°å­—ã‚’ã™ã¹ã¦è¶³ã—ã¦è¨ˆç®—ã—ã¾ã™ã€‚11, 22, 33ã¯ç‰¹åˆ¥ãªãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ã§ã™ã€‚")
